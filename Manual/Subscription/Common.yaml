# mihomo é…ç½® - å…¨å±€æœºåœºé›†ä¸­ç®¡ç†ç‰ˆ
# æ—¥æœŸï¼š2025-05-04
# ç‰¹ç‚¹ï¼šåœ¨ä¸€å¤„å®šä¹‰å¯ç”¨çš„æœºåœºï¼Œæ‰€æœ‰ç­–ç•¥ç»„è‡ªåŠ¨è·Ÿéš

port: 7890
socks-port: 7891
mixed-port: 7892
redir-port: 7893
tproxy-port: 7894

unified-delay: true
geo-auto-update: true
geo-update-interval: 24
tcp-concurrent: true
find-process-mode: strict
global-client-fingerprint: chrome
allow-lan: true
mode: rule
log-level: warning
ipv6: true
udp: true

external-controller: 0.0.0.0:9090

profile:
  store-selected: true
  store-fake-ip: true

sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports: [80, 8080-8880]
    TLS:
      ports: [443, 8443]
    QUIC:
      ports: [443, 8443]
  force-domain:
    - +.v2ex.com
  skip-domain:
    - Mijia Cloud

tun:
  enable: true
  stack: system
  dns-hijack:
    - any:53
  auto-route: true
  auto-detect-interface: true

# ç›‘å¬å™¨
listeners:
- name: socks5-in-1
  type: socks
  port: 10808
  listen: 0.0.0.0
  udp: true
  proxy: DIRECT

# DNS
dns:
  enable: true
  prefer-h3: true
  listen: 0.0.0.0:1053
  ipv6: false
  enhanced-mode: fake-ip
  fake-ip-range: 28.0.0.1/8
  fake-ip-filter:
    - "*"
    - +.lan
  default-nameserver:
    - 223.5.5.5
    - 223.6.6.6
  nameserver:
    - https://223.5.5.5/dns-query
    - https://223.6.6.6/dns-query
  fallback:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query
  fallback-filter:
    geoip: true
    geoip-code: CN
    ipcidr:
      - 240.0.0.0/4

# ==================================================
# èŠ‚ç‚¹è®¢é˜…
# ==================================================
NodeParam: &NodeParam {type: http, interval: 21600, health-check: {enable: true, url: 'http://www.gstatic.com/generate_204', interval: 30}}

proxy-providers:
  æ˜Ÿç½‘:
    url: 'https://api.starbb.sbs/api/v1/client/subscribe?token=cedde718af5b679b27d248bdc637ad99'
    <<: *NodeParam
    path: './proxy_providers/æ˜Ÿç½‘.yaml'
    override: {additional-prefix: "[æ˜Ÿç½‘]"} 
  SV_Cloud:
    url: 'https://apple-bing.sbs/s/6c9c8b9b3f4def165d444064495e6559'
    <<: *NodeParam
    path: './proxy_providers/SV_Cloud.yaml'
    override: {additional-prefix: "[SV_Cloud]"} 
  å‹è¿:
    url: 'https://79324546.youliandingyue.com/api/v1/client/subscribe?token=32df2eb3afe24d11e7da26bd99fab800'
    <<: *NodeParam
    path: './proxy_providers/å‹è¿.yaml'
    override: {additional-prefix: "[å‹è¿]"} 
  Kitty_Work:
    url: 'https://1.suika.ru/oosaka/ba188f1b8b3d905230a6b4adceb211da'
    <<: *NodeParam
    path: './proxy_providers/Kitty_Work.yaml'
    override: {additional-prefix: "[Kitty_Work]"} 
  CEEG:
    url: 'https://raw.githubusercontent.com/6666-H/Qx-Resource/refs/heads/main/Manual/Subscription/Ceegic.sub'
    <<: *NodeParam
    path: './proxy_providers/CEEG.yaml'
    override: {additional-prefix: "[CEEG]"} 

# ==================================================
# å…¨å±€æœºåœºåˆ—è¡¨ï¼ˆåªæ”¹è¿™é‡Œå³å¯æ§åˆ¶å¯ç”¨å“ªäº›æœºåœºï¼‰
# ==================================================
ProxyProvidersEnabled: &ProxyProvidersEnabled
  - CEEG
  - å‹è¿
  - SV_Cloud
  - æ˜Ÿç½‘
  - Kitty_Work


# ==================================================
# ç­–ç•¥ç»„
# ==================================================
proxy-groups:
  # æœ€ä¼˜èŠ‚ç‚¹
  - name: æœ€ä¼˜èŠ‚ç‚¹
    type: url-test
    use: *ProxyProvidersEnabled
    url: "http://www.gstatic.com/generate_204"
    interval: 300
    tolerance: 50
    timeout: 3000

  # æ‰‹åŠ¨é€‰æ‹©
  - name: æ‰‹åŠ¨é€‰æ‹©
    type: select
    use: *ProxyProvidersEnabled

  # äººå·¥æ™ºèƒ½ï¼ˆç­›é€‰ AI / ç¾åŒº èŠ‚ç‚¹ï¼‰
  - name: äººå·¥æ™ºèƒ½
    type: select
    use: *ProxyProvidersEnabled
    filter: '^(?=.*(GPT|AI|Claude|Gemini|ç¾å›½|ğŸ‡ºğŸ‡¸|US|æ´›æ‰çŸ¶|è¥¿é›…å›¾|èŠåŠ å“¥|New York|Silicon|Google))^((?!(IPLC|IEPL|æ¸¸æˆ|å›å›½|å›ç¨‹)).)*$'

  # ä»£ç†æœåŠ¡ï¼ˆé»˜è®¤ä»£ç†æµé‡ï¼‰
  - name: ä»£ç†æœåŠ¡
    type: select
    proxies:
      - æœ€ä¼˜èŠ‚ç‚¹
      - æ‰‹åŠ¨é€‰æ‹©

  # å…œåº•ç­–ç•¥
  - name: å…œåº•ç­–ç•¥
    type: select
    proxies:
      - æ‰‹åŠ¨é€‰æ‹©
      - æœ€ä¼˜èŠ‚ç‚¹
      - DIRECT

# ==================================================
# è§„åˆ™è®¢é˜…
# ==================================================
rule-providers:
  AI:
    type: http
    behavior: classical
    interval: 21600
    format: text
    path: './rules/AI.list'
    url: 'https://raw.githubusercontent.com/fmz200/wool_scripts/main/Loon/rule/AI.list'

  Proxy:
    type: http
    behavior: classical
    interval: 21600
    format: text
    path: './rules/Proxy.list'
    url: 'https://raw.githubusercontent.com/6666-H/Qx-Resource/refs/heads/main/Rule/Proxy/Proxy.list'

  LAN:
    type: http
    behavior: classical
    interval: 21600
    path: './rules/Lan.yaml'
    url: 'https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Lan/Lan.yaml'

# ==================================================
# åˆ†æµè§„åˆ™
# ==================================================
rules:
  - RULE-SET, Proxy, ä»£ç†æœåŠ¡
  - RULE-SET, AI, äººå·¥æ™ºèƒ½
  - RULE-SET, LAN, DIRECT
  - GEOIP, CN, DIRECT
  - MATCH, å…œåº•ç­–ç•¥
